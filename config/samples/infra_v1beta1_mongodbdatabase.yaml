apiVersion: infra.doodle.com/v1beta1
kind: MongoDBDatabase
metadata:
  name: mongodbdatabase-sample
  namespace: devops
spec:
  databaseName: "mongodb_sample"
  hostName: "mongodb.devops:27017"
  rootUsername: root
  rootAuthDatabase: admin
  rootSecretLookup:
    name: mongodb
    namespace: devops
    field: mongodb-root-password
  credentials:
  - username: doodle
    vault:
      useAvailable: true
      host: vault.devops
      path: secret/doodle/devbox/monolith
      userField: USERNAME
      secretField: PASSWORD
  - username: keycloak
    vault:
      useAvailable: true
      host: vault.devops
      path: secret/doodle/devbox/monolith
      userField: USERNAME
      secretField: PASSWORD
  - username: monolith-doodle
    vault:
      useAvailable: true
      host: vault.devops
      path: secret/doodle/devbox/monolith
      userField: USERNAME
      secretField: PASSWORD
